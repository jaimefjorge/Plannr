<div id="content-header">

    <h1>Votre panel de gestion</h1>
</div>
<div id="breadcrumb">
    <a href="#" class="tip-bottom" data-original-title="Go to Home"><i class="icon-home"></i>Home</a>
    <a href="#">Dashboard</a>

</div>
<div class="container-fluid">


    <div class="row-fluid">
        <div class="span12">
            <div class="widget-box">
                <div class="widget-title">
                    <span class="icon">
                        <i class="icon-exclamation-sign"></i>
                    </span>
                    <h5>Notifications</h5>
                    <span class="label label-info">2</span>
                </div>
                <div class="widget-content nopadding">

                    <ul class="activity-list">


                        @Html.Partial("_NotifsDemandesUnseen")

                        <li>
                            <a href="#"><i class="icon-user"></i>Vous avez 4 demandes de réservations en cours</a>
                        </li>
                    </ul>
                </div>
            </div>






            <div class="widget-box">
                <div class="widget-title">
                    <span class="icon">
                        <i class="icon-th"></i>

                    </span>
                    <h5>Mon emploi du temps</h5>
                    <div class="buttons">
                        <a title="Icon Title" class="btn btn-mini btn-info" href="#" id="precWeek"><i class="icon-step-backward icon-white"></i>Semaine précédente</a>
                        <a title="Icon Title" class="btn btn-mini btn-info" href="#" id="nextWeek">Semaine suivante <i class="icon-step-forward icon-white"></i></a>
                    </div>
                </div>
                <div class="widget-content nopadding">
                    <div id="calendar">
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>

<script type="text/javascript">

    $('#precWeek').live('click',function() {

        $("#calendar").weekCalendar("prevWeek");

    });

    $("#nextWeek").live('click',function() {
        $("#calendar").weekCalendar("nextWeek");
    });

    
    var eventsNET = @Html.Raw(@ViewBag.resaJSON);

    var mapped = _.map(eventsNET,function(item) {

        item.start = new Date(item.start*1000);
        item.end = new Date(item.end*1000);
        return item;

    });

  

    var year = new Date().getFullYear();
    var month = new Date().getMonth();
    var day = new Date().getDate();

    var eventData = {
        events: mapped
    };


    $('#calendar').weekCalendar({
        timeslotsPerHour: 2,
        timeslotHeigh: 60,
            
        hourLine: true,
        data: eventData,
        limitDisplay: true,
        use24Hour:true,
        height: function ($calendar) {
            return 600;
        },
        firstDayOfWeek:1,
        businessHours: {
            start: 8,
            end: 20,
            limitDisplay: true
        },
        allowCalEventOverlap: false,
        buttons: true,
        daysToShow:5,
        eventNew: function (calEvent, $event) {
            displayMessage('<strong>Added event</strong><br/>Start: ' + calEvent.start + '<br/>End: ' + calEvent.end);
            alert('You\'ve added a new event. You would capture this event, add the logic for creating a new event with your own fields, data and whatever backend persistence you require.');
        },
        eventDrop: function (calEvent, $event) {
            displayMessage('<strong>Moved Event</strong><br/>Start: ' + calEvent.start + '<br/>End: ' + calEvent.end);
        },
        eventResize: function (calEvent, $event) {
            displayMessage('<strong>Resized Event</strong><br/>Start: ' + calEvent.start + '<br/>End: ' + calEvent.end);
        },
        eventClick: function (calEvent, $event) {
            displayMessage('<strong>Clicked Event</strong><br/>Start: ' + calEvent.start + '<br/>End: ' + calEvent.end);
        },
        eventMouseover: function (calEvent, $event) {
            displayMessage('<strong>Mouseover Event</strong><br/>Start: ' + calEvent.start + '<br/>End: ' + calEvent.end);
        },
        eventMouseout: function (calEvent, $event) {
            displayMessage('<strong>Mouseout Event</strong><br/>Start: ' + calEvent.start + '<br/>End: ' + calEvent.end);
        },
        noEvents: function () {
            displayMessage('There are no events for this week');
        }
    });

    function displayMessage(message) {
        //$('#message').html(message).fadeIn();
    }

    //$('<div id="message" class="ui-corner-all"></div>').prependTo($('body'));
    
</script>
