@model IEnumerable<Plannr.Models.DemandeReservation>

@{
    ViewBag.Title = "Index";
}
<div id="demandesContainer">
    <div id="content-header">
        <h1>Demandes de réservations</h1>
    </div>
    <div id="breadcrumb">
        <a href="#" class="tip-bottom" data-original-title="Go to Home"><i class="icon-home"></i>Home</a>
        <a href="#">Demandes de réservations</a>
        <a href="#" class="current">Listing</a>
    </div>


    @Html.Partial("_BookList", Model)

    <center>
   <a href="@Url.Action("Create", "Book")" class="btn btn-large btn-primary" id="makeDemand"><i class="icon-pencil icon-white"></i> Faire une demande de réservation</a>
</center>
</div>


<div id="editContainer" style="display: none;">
</div>

<script type="text/javascript">
    $(function () {
        var editLoaded = false;

        function showEdit() {
            $('#demandesContainer').fadeOut("fast", function () {
                $('#editContainer').fadeIn()
            })
            
        }

        function showDemandes() {
            $('#editContainer').fadeOut("fast", function () {
                $('#demandesContainer').fadeIn()
            })

        }

        $('#cancelEdit').live('click', function (e) {

            showDemandes()

            e.preventDefault()
            return false
        })

        $('#makeDemand').bind('click', function (e) {
            if (!editLoaded) {
                $.get("@Url.Action("Create", "Book")", function (data) {

                    $('#editContainer').html(data)
                    showEdit()
                    editLoaded = true
                })

            } else {
                showEdit()
            }
            e.preventDefault()
            e.stopPropagation()
            return false
        })

        $('#CreateDemandesForm').live('submit', function (e) {


            console.log('bleh');
            var newDemande = new Demande({ Enseignement: { 'Id': $('#Enseignement_Id').val() } })
            newDemande.save()


            e.preventDefault()
            return false
        })

    })
</script>
</div>